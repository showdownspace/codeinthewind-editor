"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3880],{3880:function(e,t,n){n.r(t),n.d(t,{go:function(){return w}});var r=n(8520),a=n.n(r),s=n(737),o=n(5503),c=n(5762),i=n(4642),u=n(7702),d=(0,o.ZF)({apiKey:"AIzaSyC2K76ycMyLhAYOd_XOa3aC3Cnqe6dEno0",authDomain:"showdownspace.firebaseapp.com",databaseURL:"https://showdownspace-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"showdownspace",storageBucket:"showdownspace.appspot.com",messagingSenderId:"999073329546",appId:"1:999073329546:web:08df5e95a021605ca49873",measurementId:"G-9LV3C4S19C"}),h=((0,c.IH)(d),(0,i.N8)(d),(0,u.v0)(d)),l=new Promise((function(e){(0,u.Aj)(h,(function(t){e()}))}));function p(e,t,n,r,a,s,o){try{var c=e[s](o),i=c.value}catch(u){return void n(u)}c.done?t(i):Promise.resolve(i).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){p(s,r,a,o,c,"next",e)}function c(e){p(s,r,a,o,c,"throw",e)}o(void 0)}))}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){m(e,t,n[t])}))}return e}function w(){return v.apply(this,arguments)}function v(){return(v=f(a().mark((function e(){var t,n,r,o,c,d,p,f,m,w,v,g,y,k,x,C,O,S,_,P,j,I,N,U;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:if(!(t=window.location.hash.match(/auth_token=([^&]+)/))){e.next=8;break}return n=t[1],e.next=7,(0,u._p)(h,n);case 7:window.location.replace(window.location.hash.replace(/auth_token=[^&]+/,"_=_"));case 8:if(h.currentUser){e.next=11;break}return s.h.state={state:"error",message:"You are not authenticated",details:"Changes will not be saved. Please access Code in the Wind Editor from the link provided to you in Discord."},e.abrupt("return");case 11:return r=h.currentUser,e.next=14,r.getIdTokenResult();case 14:return o=e.sent,c=o.claims.name,s.h.state={state:"idle",message:"[".concat(c,"] Authenticated")},d=(0,i.iH)((0,i.N8)()),p=(0,i.iU)(d,"rooms/citw"),f=(0,i.iU)(p,"publicSubmissions/".concat(r.uid)),e.next=22,(0,i.U2)(f);case 22:m=e.sent,w="meow",v={},m.exists()?(g=m.child("data").val(),v=JSON.parse(g),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Content restored (size=").concat(g.length,")"),overrideInitialContent:b({},v.html?{html:v.html}:{},v.css?{css:v.css}:{},v.compiledCss?{compiledCss:v.compiledCss}:{}),synchronizeToken:w})):s.h.state=b({},s.h.state,{synchronizeToken:w});case 26:for(e.prev=26,y=Object.keys(s.if),k=0,x=!0,C=!1,O=void 0,e.prev=30,S=y[Symbol.iterator]();!(x=(_=S.next()).done);x=!0)P=_.value,v[P]!==s.if[P]&&(v[P]=s.if[P],k++),delete s.if[P];e.next=38;break;case 34:e.prev=34,e.t0=e.catch(30),C=!0,O=e.t0;case 38:e.prev=38,e.prev=39,x||null==S.return||S.return();case 41:if(e.prev=41,!C){e.next=44;break}throw O;case 44:return e.finish(41);case 45:return e.finish(38);case 46:if(!(k>0)){e.next=54;break}return j=JSON.stringify(v),e.next=50,(0,i.t8)(f,{data:j,submittedAt:(0,i.Bt)()});case 50:I=new Date,N=function(e){return e<10?"0"+e:e},U=I.getHours()+":"+N(I.getMinutes())+":"+N(I.getSeconds()),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Saved at ").concat(U," (size=").concat(j.length,")")});case 54:e.next=60;break;case 56:e.prev=56,e.t1=e.catch(26),console.error(e.t1),s.h.state=b({},s.h.state,{state:"error",message:"[".concat(c,"] Sync error"),details:String(e.t1)});case 60:return e.next=62,new Promise((function(e){return setTimeout(e,3e3)}));case 62:e.next=26;break;case 64:case"end":return e.stop()}}),e,null,[[26,56],[30,34,38,46],[39,,41,45]])})))).apply(this,arguments)}}}]);