"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3880],{3880:function(e,t,n){n.r(t),n.d(t,{go:function(){return w}});var a=n(8520),r=n.n(a),s=n(737),o=n(5503),c=n(5762),i=n(4642),u=n(7702),h=(0,o.ZF)({apiKey:"AIzaSyC2K76ycMyLhAYOd_XOa3aC3Cnqe6dEno0",authDomain:"showdownspace.firebaseapp.com",databaseURL:"https://showdownspace-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"showdownspace",storageBucket:"showdownspace.appspot.com",messagingSenderId:"999073329546",appId:"1:999073329546:web:08df5e95a021605ca49873",measurementId:"G-9LV3C4S19C"}),d=((0,c.IH)(h),(0,i.N8)(h),(0,u.v0)(h)),l=new Promise((function(e){(0,u.Aj)(d,(function(t){e()}))}));function p(e,t,n,a,r,s,o){try{var c=e[s](o),i=c.value}catch(u){return void n(u)}c.done?t(i):Promise.resolve(i).then(a,r)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function o(e){p(s,a,r,o,c,"next",e)}function c(e){p(s,a,r,o,c,"throw",e)}o(void 0)}))}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){m(e,t,n[t])}))}return e}function w(){return v.apply(this,arguments)}function v(){return(v=f(r().mark((function e(){var t,n,a,o,c,h,p,f,m,w,v,g,k,x,S,O,C,I,_,P,N,j,E,T;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:if(!(t=window.location.hash.match(/auth_token=([^&]+)/))){e.next=8;break}return n=t[1],e.next=7,(0,u._p)(d,n);case 7:window.location.replace(window.location.hash.replace(/auth_token=[^&]+/,"_=_"));case 8:if(d.currentUser){e.next=11;break}return s.h.state={state:"error",message:"You are not authenticated",details:"Changes will not be saved. Please access Code in the Wind Editor from the link provided to you in Discord."},e.abrupt("return");case 11:return a=d.currentUser,e.next=14,a.getIdTokenResult();case 14:return o=e.sent,c=o.claims.name,s.h.state={state:"idle",message:"[".concat(c,"] Authenticated")},h=(0,i.iH)((0,i.N8)()),p=(0,i.iU)(h,"rooms/citw"),f=(0,i.iU)(p,"publicSubmissions/".concat(a.uid)),e.next=22,(0,i.U2)(f);case 22:m=e.sent,w="meow",v={},m.exists()?(g=m.child("data").val(),v=JSON.parse(g),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Content restored (size=").concat(g.length,")"),overrideInitialContent:b({},v.html?{html:v.html}:{},v.css?{css:v.css}:{},v.compiledCss?{compiledCss:v.compiledCss}:{}),synchronizeToken:w})):s.h.state=b({},s.h.state,{synchronizeToken:w});case 26:for(e.prev=26,k=Object.keys(s.if),x=0,S=!0,O=!1,C=void 0,e.prev=30,I=k[Symbol.iterator]();!(S=(_=I.next()).done);S=!0)P=_.value,v[P]!==s.if[P]&&(v[P]=s.if[P],x++),delete s.if[P];e.next=38;break;case 34:e.prev=34,e.t0=e.catch(30),O=!0,C=e.t0;case 38:e.prev=38,e.prev=39,S||null==I.return||I.return();case 41:if(e.prev=41,!O){e.next=44;break}throw C;case 44:return e.finish(41);case 45:return e.finish(38);case 46:if(!(x>0)){e.next=54;break}return N=JSON.stringify(v),e.next=50,(0,i.t8)(f,{data:N,submittedAt:(0,i.Bt)()});case 50:j=new Date,E=function(e){return e<10?"0"+e:e},T=j.getHours()+":"+E(j.getMinutes())+":"+E(j.getSeconds()),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Saved at ").concat(T," (size=").concat(N.length,")")});case 54:e.next=60;break;case 56:e.prev=56,e.t1=e.catch(26),console.error(e.t1),s.h.state=b({},s.h.state,{state:"error",message:"[".concat(c,"] Sync error"),details:String(e.t1)+y(String(e.t1))+"\n\nYour submission has NOT been saved. To avoid losing your work, please make a backup copy of your code and then reload the page."});case 60:return e.next=62,new Promise((function(e){return setTimeout(e,3e3)}));case 62:e.next=26;break;case 64:case"end":return e.stop()}}),e,null,[[26,56],[30,34,38,46],[39,,41,45]])})))).apply(this,arguments)}function y(e){return e.match(/PERMISSION_DENIED/)?"\n\nThis is most likely because the editor has been locked because either the time is up or the game hasn\u2019t been started yet.":""}}}]);