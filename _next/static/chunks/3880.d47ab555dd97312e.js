"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3880],{3880:function(e,t,n){n.r(t),n.d(t,{go:function(){return v}});var r=n(8520),a=n.n(r),s=n(737),o=n(5503),c=n(5762),i=n(4642),u=n(7702),p=(0,o.ZF)({apiKey:"AIzaSyC2K76ycMyLhAYOd_XOa3aC3Cnqe6dEno0",authDomain:"showdownspace.firebaseapp.com",databaseURL:"https://showdownspace-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"showdownspace",storageBucket:"showdownspace.appspot.com",messagingSenderId:"999073329546",appId:"1:999073329546:web:08df5e95a021605ca49873",measurementId:"G-9LV3C4S19C"}),l=((0,c.IH)(p),(0,i.N8)(p),(0,u.v0)(p)),h=new Promise((function(e){(0,u.Aj)(l,(function(t){e()}))}));function d(e,t,n,r,a,s,o){try{var c=e[s](o),i=c.value}catch(u){return void n(u)}c.done?t(i):Promise.resolve(i).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){d(s,r,a,o,c,"next",e)}function c(e){d(s,r,a,o,c,"throw",e)}o(void 0)}))}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){m(e,t,n[t])}))}return e}function v(){return w.apply(this,arguments)}function w(){return(w=f(a().mark((function e(){var t,n,r,o,c,p,d,m,v,w,k,g,x,S,O,C,I,_,P,U,N,j,E,T;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h;case 2:if(!(t=window.location.hash.match(/auth_token=([^&]+)/))){e.next=8;break}return n=t[1],e.next=7,(0,u._p)(l,n);case 7:window.location.replace(window.location.hash.replace(/auth_token=[^&]+/,"_=_"));case 8:if(l.currentUser){e.next=11;break}return s.h.state={state:"error",message:"You are not authenticated",details:"Changes will not be saved. Please access Code in the Wind Editor from the link provided to you in Discord."},e.abrupt("return");case 11:return r=l.currentUser,e.next=14,r.getIdTokenResult();case 14:return o=e.sent,c=o.claims.name,s.h.state={state:"idle",message:"[".concat(c,"] Authenticated")},p=(0,i.iH)((0,i.N8)()),d=(0,i.iU)(p,"rooms/citw"),m=(0,i.iU)(d,"publicSubmissions/".concat(r.uid)),e.next=22,(0,i.U2)(m);case 22:function D(){return z.apply(this,arguments)}function z(){return(z=f(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,i.iU)(d,"presence/".concat(r.uid)),e.next=4,(0,i.t8)(t,(0,i.Bt)());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Unable to save presence info",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function A(){return B.apply(this,arguments)}function B(){return(B=f(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,i.iU)(d,"profiles/".concat(r.uid)),e.next=4,(0,i.t8)(t,{name:c});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Unable to save profile info",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}v=e.sent,w="meow",k={},v.exists()?(g=v.child("data").val(),k=JSON.parse(g),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Content restored (size=").concat(g.length,")"),overrideInitialContent:b({},k.html?{html:k.html}:{},k.css?{css:k.css}:{},k.compiledCss?{compiledCss:k.compiledCss}:{}),synchronizeToken:w})):s.h.state=b({},s.h.state,{synchronizeToken:w}),D(),A(),setInterval((function(){return D()}),1e4);case 33:for(e.prev=33,x=Object.keys(s.if),S=0,O=!0,C=!1,I=void 0,e.prev=37,_=x[Symbol.iterator]();!(O=(P=_.next()).done);O=!0)U=P.value,k[U]!==s.if[U]&&(k[U]=s.if[U],S++),delete s.if[U];e.next=45;break;case 41:e.prev=41,e.t0=e.catch(37),C=!0,I=e.t0;case 45:e.prev=45,e.prev=46,O||null==_.return||_.return();case 48:if(e.prev=48,!C){e.next=51;break}throw I;case 51:return e.finish(48);case 52:return e.finish(45);case 53:if(!(S>0)){e.next=61;break}return N=JSON.stringify(k),e.next=57,(0,i.t8)(m,{data:N,submittedAt:(0,i.Bt)()});case 57:j=new Date,E=function(e){return e<10?"0"+e:e},T=j.getHours()+":"+E(j.getMinutes())+":"+E(j.getSeconds()),s.h.state=b({},s.h.state,{state:"idle",message:"[".concat(c,"] Saved at ").concat(T," (size=").concat(N.length,")")});case 61:e.next=67;break;case 63:e.prev=63,e.t1=e.catch(33),console.error(e.t1),s.h.state=b({},s.h.state,{state:"error",message:"[".concat(c,"] Sync error"),details:String(e.t1)+y(String(e.t1))+"\n\nYour submission has NOT been saved. To avoid losing your work, please make a backup copy of your code and then reload the page."});case 67:return e.next=69,new Promise((function(e){return setTimeout(e,3e3)}));case 69:e.next=33;break;case 71:case"end":return e.stop()}}),e,null,[[33,63],[37,41,45,53],[46,,48,52]])})))).apply(this,arguments)}function y(e){return e.match(/PERMISSION_DENIED/)?"\n\nThis is most likely because the editor has been locked because either the time is up or the game hasn\u2019t been started yet.":""}}}]);